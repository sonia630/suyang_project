<%@ taglib prefix="fmt" uri="http://java.sun.com/jstl/fmt_rt" %><%@ page contentType="text/html;charset=UTF-8"%><!doctype html><html><head>    <script type="text/javascript"            src="http://api.map.baidu.com/api?v=2.0&ak=7uEG0qE4p5ALZfO3a3x2U8LeYkY05Mud"></script>    <jsp:include page="include/header.jsp"/>    <style>        .am-panel-bd.time span{            cursor: no-drop;            color: #999;        }        .am-panel-bd.time span:hover {            background: #F0F0F0;            height: 34px;            width: 34px;        }    </style></head></head><body class="am-animation-slide-right"><!-- Topbar --><div class="topbar">    <ul class="am-g">        <li class="am-u-sm-1" id="back"><i class="am-icon-angle-left am-icon-sm"></i></li>        <li class="title am-text-center am-u-sm-10">选择上门时间</li>        <li class="am-u-sm-1 am-text-right"></li>    </ul></div><div class="select-time am-panel-group">    <div class="am-panel am-panel-default">        <div class="am-panel-hd">            <h3 class="am-panel-title">未来一个月可预约时间（北京时间）</h3>        </div>        <div class="am-panel-bd am-padding-0">            <input type="text" id="date" class="am-hide"/>            <div id="calendar"></div>        </div>    </div>    <div class="am-panel am-panel-default">        <div class="am-panel-hd">            <h3 class="am-panel-title">上午</h3>        </div>        <div class="am-panel-bd time">            <span id="time1">08:00</span>            <span id="time2">08:30</span>            <span id="time3">09:00</span>            <span id="time4">09:30</span>            <span id="time5">10:00</span>            <span id="time6">10:30</span>            <span id="time7">11:00</span>            <span id="time8">11:30</span>            <span id="time9">12:00</span>            <span id="time10">12:30</span>        </div>    </div>    <div class="am-panel am-panel-default">        <div class="am-panel-hd">            <h3 class="am-panel-title">下午</h3>        </div>        <div class="am-panel-bd time">            <span id="time11">13:00</span>            <span id="time12">13:30</span>            <span id="time13">14:00</span>            <span id="time14">14:30</span>            <span id="time15">15:00</span>            <span id="time16">15:30</span>            <span id="time17">16:00</span>            <span id="time18">16:30</span>            <span id="time19">17:00</span>            <span id="time20">17:30</span>        </div>    </div>    <div class="am-panel am-panel-default">        <div class="am-panel-hd">            <h3 class="am-panel-title">晚上</h3>        </div>        <div class="am-panel-bd time">            <span id="time21">18:00</span>            <span id="time22">18:30</span>            <span id="time23">19:00</span>            <span id="time24">19:30</span>            <span id="time25">20:00</span>        </div>    </div></div><div class="am-navbar navbar-button am-g">    <div class="am-u-sm-6 time-result am-margin-top-sm">        <i class="am-icon-calendar"></i>        <span>2月8日</span><span>周四</span><span>10:30</span>    </div>    <div class="am-u-sm-5">        <button onclick="slideLeft()" class="am-btn am-btn-block am-btn-primary am-vertical-align-middle am-btn-lg">确            定        </button>    </div></div><div class="am-navbar navbar-button am-g">    <div class="am-u-sm-6 time-result am-margin-top-sm" style="margin-top: 7px;">        <span id="day"></span><span id="week"></span><span id="time"></span>    </div>    <div class="am-u-sm-5">        <button onclick="ok()" class="am-disabled am-btn am-btn-block am-btn-primary am-vertical-align-middle am-btn-lg" id="ok">确            定        </button>    </div></div><div style="display: none" id="container"></div><div style="display: none" id="time_result"></div><div style="display: none" id="providerId"></div><jsp:include page="include/js.jsp"/></body><script>    var weekday=new Array(7)    weekday[0]="周日";    weekday[1]="周一";    weekday[2]="周二";    weekday[3]="周三";    weekday[4]="周四";    weekday[5]="周五";    weekday[6]="周六";  $(function () {      slideRight ();      $("#back").click(function () {          window.location.href = "${from}?serviceId=${serviceId}";      });      var map = new BMap.Map("container");      var mPoint = new BMap.Point(${lng},${lat});      var circle = new BMap.Circle(mPoint, ${span});      map.addOverlay(circle);        //添加一个圆形覆盖物      var data = {          "date": "${time}",          "neLongitude": circle.getBounds().getNorthEast().lng,          "neLatitude": circle.getBounds().getNorthEast().lat,          "swLongitude": circle.getBounds().getSouthWest().lng,          "swLatitude": circle.getBounds().getSouthWest().lat      };      initCalendar(data);  })  function fillSchedule(data) {      $(".am-panel-bd.time span").prop("style","");      $("#ok").addClass("am-disabled");      $(".am-panel-bd.time span").removeClass("active");      $.ajax({         type: "post",         async: false,         data: data,         dataType: "json",         url: "/common/schedule",     }).done(function (e) {          $.each(e , function (index, value){              $("#time" + index).prop("style","color: #89d7ff;");              $("#time" + index).click(function () {                  $(".am-panel-bd.time span").removeClass("active");                  $(this).addClass("active");                  $("#time").html($(this).html());                  $("#time_result").html($("#time_result").html() + " " + $(this).html());                  $("#ok").removeClass("am-disabled");              });              $("#providerId").html(value[0]);          });      }).fail(function (e) {          $.toptip(e.message, e.status);      });  }  function initCalendar (data) {    $('#calendar').calendar({      container: '#calendar',      input: '#date',      onChange: function (p, values, displayValues) {          data.date = values[0];          $("#time_result").html(values[0]);          $("#providerId").html("");          fillSchedule(data);          var unixTimestamp = new Date(displayValues[0]);          $("#day").html((unixTimestamp.getMonth() + 1) + "月" + unixTimestamp.getDate() + "日");          $("#week").html(weekday[unixTimestamp.getDay()]);      }    })  }  function slideRight () {    $('.topbar').css('position', 'initial')    let clientHeight = document.documentElement.clientHeight - 43    $('.select-time').css({'height': clientHeight}).addClass('slideBarLeft')    console.log('clientHeight', clientHeight)    // $('.topbar').css('position', 'fixed')    setTimeout(function () {        $('body').removeClass('am-animation-slide-right')        $('.select-time').css({'height': 'auto'}).addClass('sliderMargin').removeClass('slideBarLeft')        $('.topbar').css('position', 'fixed')    }, 400)  }  function ok() {     if ($(this).hasClass("am-disabled")) {          return;     }     $.cookie('s3_time',$("#time_result").html(),{expires: 0.1, path: "/"});     window.location.href = "${from}?serviceId=${serviceId}&providerId="+$("#providerId").html();  }</script></html>